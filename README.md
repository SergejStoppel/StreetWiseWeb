# üåê SiteCraft V3

> **Multi-Tenant Accessibility Analysis Platform**

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Node.js](https://img.shields.io/badge/Node.js-18+-green.svg)](https://nodejs.org/)
[![React](https://img.shields.io/badge/React-18+-blue.svg)](https://reactjs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5+-blue.svg)](https://www.typescriptlang.org/)
[![Supabase](https://img.shields.io/badge/Database-Supabase-green.svg)](https://supabase.com/)
[![Docker](https://img.shields.io/badge/Docker-Ready-blue.svg)](https://www.docker.com/)

SiteCraft V3 is a next-generation, multi-tenant accessibility analysis platform that provides comprehensive website compliance analysis with WCAG guidelines. Featuring workspace-based collaboration, advanced rule engines, and enterprise-grade security.

## ‚ú® Features

| Feature | Description |
|---------|-------------|
| üè¢ **Multi-Tenant Architecture** | Workspace-based collaboration with role-based access control |
| üîê **Enterprise Authentication** | Complete auth flow with email confirmation, password reset, account management |
| üîç **Advanced Analysis Engine** | 100+ rules covering Accessibility, SEO, and Performance |
| ‚ö° **Real-time Analysis** | Three-tier pipeline with Master, Fetcher, and Analyzer workers |
| üìä **WCAG Compliance** | Complete WCAG 2.1 AA/AAA mapping with educational content |
| üéØ **Intelligent Prioritization** | Business impact scoring and conversion rate analysis |
| üíæ **Cloud Storage** | Supabase storage with CDN delivery for screenshots |
| üë• **Workspace Management** | Invite members, manage roles, and collaborate on analyses |
| üìà **Analytics Dashboard** | Historical tracking and progress monitoring |
| üåô **Modern UI** | Dark/light mode with responsive design |
| üåê **Internationalization** | Multi-language support with i18next |
| üìÑ **Export & Sharing** | Professional reports with public sharing links |
| üê≥ **Production Ready** | Docker deployment with health checks and monitoring |
| üîí **Security First** | Row Level Security, audit logging, and comprehensive validation |

## üõ†Ô∏è Tech Stack

### Backend V3 (TypeScript)
- **Runtime**: Node.js 18+ with Express.js and full TypeScript support
- **Database**: Supabase PostgreSQL with Row Level Security and multi-tenancy
- **Queue System**: BullMQ with Redis for job processing and analysis pipeline
- **Authentication**: Complete Supabase Auth integration with workspace management
- **Analysis Engine**: Modular system with 100+ rules for Accessibility, SEO, Performance
- **Security**: Helmet, CORS, rate limiting, JWT validation, and audit logging
- **Logging**: Winston with structured logging and environment-aware configuration
- **Validation**: Zod schemas for comprehensive input validation

### Frontend (React + TypeScript)
- **Framework**: React 18 with TypeScript and modern hooks
- **Styling**: Styled Components with comprehensive theme system
- **Routing**: React Router v6 with workspace-aware protected routes
- **State Management**: Context API with workspace and authentication contexts
- **API Client**: Axios with interceptors, error handling, and retry logic
- **UI Components**: Custom component library with accessibility focus
- **Internationalization**: i18next with dynamic language switching
- **Build Tool**: Create React App with TypeScript template

### Infrastructure & DevOps
- **Database**: Multi-tenant Supabase setup with development/production projects
- **Authentication**: Supabase Auth with email confirmation and password management
- **Storage**: Supabase Storage with bucket policies and CDN optimization
- **Deployment**: Docker multi-stage builds with development and production configurations
- **Environment**: Unified .env system supporting dev/prod environment switching
- **Monitoring**: Health checks, structured logging, and comprehensive error tracking
- **Job Processing**: Redis-backed queue system for scalable analysis processing

## üöÄ Quick Start

### Prerequisites
- **Node.js** v18 or higher
- **Docker** and **Docker Compose** (optional, for containerized development)
- **Git** for version control
- **Supabase Account** (free tier available - you'll need separate dev/prod projects)

### Installation

1. **Clone the repository**
   ```bash
   git clone https://github.com/your-username/sitecraft.git
   cd sitecraft
   ```

2. **Install all dependencies** (root, backend, and frontend)
   ```bash
   npm run install-all
   ```

3. **Environment Configuration**
   ```bash
   # Copy the unified environment template
   cp .env.example .env
   ```
   
   **Configure your `.env` file:**
   ```bash
   # ===========================================
   # ENVIRONMENT SELECTOR
   # ===========================================
   APP_ENV=development  # Change to 'production' when ready
   
   # ===========================================
   # DEVELOPMENT SUPABASE CONFIG
   # ===========================================
   DEV_SUPABASE_URL=https://your-dev-project-id.supabase.co
   DEV_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   DEV_SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   
   # ===========================================
   # PRODUCTION SUPABASE CONFIG (when ready)
   # ===========================================
   PROD_SUPABASE_URL=https://your-prod-project-id.supabase.co
   PROD_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   PROD_SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   ```

4. **Database Setup**
   
   Run the database setup scripts in your Supabase project:
   ```bash
   # Execute scripts in order in your Supabase SQL editor:
   # 1. database/setup/01_extensions_and_types.sql
   # 2. database/setup/02_core_tables.sql
   # 3. database/setup/03_analysis_engine_tables.sql
   # 4. database/setup/04_issues_tables.sql
   # 5. database/setup/05_billing_tables.sql
   # 6. database/setup/06_reporting_audit_tables.sql
   # 7. database/setup/07_functions.sql
   # 8. database/setup/08_triggers.sql
   # 9. database/setup/09_rls_policies.sql
   # 10. database/setup/10_initial_data.sql
   ```

## üöÄ Running the Application

### Option 1: Local Development (Recommended for development)

**Start the full application locally:**
```bash
npm run start:dev  # Uses APP_ENV=development
```

This will start:
- **Backend API** at http://localhost:3005
- **Frontend** at http://localhost:3000
- **Automatic reload** on code changes

**Alternative: Start components individually**
```bash
# Backend only (development mode)
npm run backend

# Frontend only 
npm run frontend

# Both with concurrently
npm run dev
```

### Option 2: Docker Development (For testing containerization)

**Start with Docker (development environment):**
```bash
# Start development containers with hot reload
npm run docker:dev

# Or run in background
npm run docker:dev:detached

# View logs
npm run docker:logs

# Check service health
npm run health:docker
```

### Option 3: Production Deployment

**Local production build:**
```bash
# Set environment to production in .env
APP_ENV=production

# Build and start production
npm run start:prod
```

**Docker production:**
```bash
# Start production containers
npm run docker:prod

# Or run in background
npm run docker:prod:detached
```

### üîç Monitoring & Health Checks

```bash
# Check if all services are running
npm run health

# View Docker logs
npm run docker:logs:backend
npm run docker:logs:frontend

# Stop all Docker services
npm run docker:stop

# Clean up Docker resources
npm run docker:clean
```

## üìñ How to Use SiteCraft V3

### üîê Authentication & Account Management

**Complete authentication system with:**
- ‚úÖ **Sign Up** with email confirmation required
- ‚úÖ **Sign In** with proper error handling for wrong passwords
- ‚úÖ **Email Confirmation** - users must confirm email before accessing
- ‚úÖ **Password Reset** via email with secure token-based flow
- ‚úÖ **Account Settings** - change email, password, or delete account
- ‚úÖ **Account Deletion** with complete data cleanup

### üè¢ Multi-Tenant Workspace Management

1. **Create Workspace**
   - Set up your organization's workspace
   - Automatically become the workspace owner

2. **Invite Team Members**
   - Add members with different roles: Owner, Admin, Member
   - Manage permissions and access levels

3. **Workspace Collaboration**
   - Share analyses across team members
   - Track team progress and history

### üîç Website Analysis (Coming Soon)

The analysis engine includes 100+ rules covering:
- **Accessibility**: WCAG 2.1 AA/AAA compliance with educational content
- **SEO**: Technical and content optimization with business impact
- **Performance**: Core Web Vitals and conversion rate analysis

### üõ°Ô∏è Analysis Features

#### Comprehensive Accessibility Checks
- ‚úÖ **Image Accessibility** - Alt text validation and decorative image detection
- ‚úÖ **Form Controls** - Label associations and form validation
- ‚úÖ **Color Contrast** - WCAG AA/AAA contrast ratio analysis
- ‚úÖ **Heading Structure** - Logical heading hierarchy validation
- ‚úÖ **Link Quality** - Link text and context analysis
- ‚úÖ **ARIA Implementation** - Proper ARIA attributes and roles
- ‚úÖ **Keyboard Navigation** - Tab order and focus management
- ‚úÖ **Semantic HTML** - Proper use of HTML5 semantic elements
- ‚úÖ **Page Structure** - Landmarks and content organization

#### Scoring System
| Score Type | Range | Description |
|------------|-------|-------------|
| **Overall Score** | 0-100 | Combined accessibility and usability rating |
| **Accessibility Score** | 0-100 | WCAG 2.1 compliance percentage |
| **SEO Score** | 0-100 | Search engine optimization rating |
| **Performance Score** | 0-100 | Page load and performance metrics |

#### Detailed Reports Include
- üìà **Executive Summary** - Key metrics and priority issues
- üîç **Detailed Violations** - Complete issue descriptions with examples
- üéØ **Prioritized Recommendations** - Actionable fixes ordered by impact
- üì∏ **Visual Evidence** - Screenshots highlighting issues
- üèóÔ∏è **Technical Guidance** - Element-specific code examples
- üìä **Progress Tracking** - Historical analysis comparison

### üîå API Endpoints

```http
# Authentication
POST /api/auth/signup               # Register new user
POST /api/auth/signin               # Sign in user
POST /api/auth/signout              # Sign out user
POST /api/auth/forgot-password      # Send password reset email
POST /api/auth/reset-password       # Reset password with token
GET  /api/auth/me                   # Get current user profile
PUT  /api/auth/profile              # Update user profile
PUT  /api/auth/password             # Update user password
DELETE /api/auth/account            # Delete user account
POST /api/auth/resend-confirmation  # Resend email confirmation

# Workspaces
GET  /api/workspaces                # Get user's workspaces
POST /api/workspaces                # Create new workspace
GET  /api/workspaces/:id            # Get workspace details
PUT  /api/workspaces/:id            # Update workspace
DELETE /api/workspaces/:id          # Delete workspace (owner only)
POST /api/workspaces/:id/members    # Invite member
PUT  /api/workspaces/:id/members/:userId  # Update member role
DELETE /api/workspaces/:id/members/:userId # Remove member
POST /api/workspaces/:id/leave      # Leave workspace

# Health & Monitoring
GET  /api/health                    # API health check
GET  /                              # API info and documentation
```

## üèóÔ∏è Project Structure

```
sitecraft/
‚îú‚îÄ‚îÄ üìÅ backend/                     # TypeScript Backend V3
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ api/                # API layer
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ controllers/    # Request handlers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ middleware/     # Auth, validation, error handling
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ routes/         # Route definitions
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ validators/     # Zod validation schemas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ config/             # Configuration management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ core/               # Core business logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ analysis/       # Analysis engine modules
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ auth/           # Authentication services
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ billing/        # Billing and subscription logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ reporting/      # Report generation
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ db/                 # Database utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ lib/                # Shared libraries
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ types/              # TypeScript type definitions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ utils/              # Utility functions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ workers/            # Background job workers
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ server.ts           # Main server file
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ Dockerfile.dev          # Development container
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ Dockerfile.prod         # Production container
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ package.json
‚îú‚îÄ‚îÄ üìÅ frontend/                   # React TypeScript Frontend
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ components/         # Reusable UI components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ pages/              # Page components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ services/           # API client services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ hooks/              # Custom React hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ context/            # React context providers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ theme/              # Styling and theme system
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ utils/              # Frontend utilities
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ public/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ locales/            # Internationalization files
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ Dockerfile.dev          # Development container
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ Dockerfile.prod         # Production container
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ nginx.conf              # Nginx configuration
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ package.json
‚îú‚îÄ‚îÄ üìÅ database/                   # Database Setup Scripts
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ setup/                  # Modular setup scripts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 01_extensions_and_types.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 02_core_tables.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 03_analysis_engine_tables.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 04_issues_tables.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 05_billing_tables.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 06_reporting_audit_tables.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 07_functions.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 08_triggers.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 09_rls_policies.sql
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ 10_initial_data.sql
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ README.md
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ database_schema.dbml    # Database schema definition
‚îú‚îÄ‚îÄ üìÅ docs/                       # Project Documentation
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ backend-v2-plan/        # Backend implementation plan
‚îú‚îÄ‚îÄ üìÅ scripts/                    # Utility scripts
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ health-check.js         # Service health monitoring
‚îú‚îÄ‚îÄ üìÑ docker-compose.dev.yml      # Development Docker setup
‚îú‚îÄ‚îÄ üìÑ docker-compose.prod.yml     # Production Docker setup
‚îú‚îÄ‚îÄ üìÑ .env.example                # Unified environment template
‚îú‚îÄ‚îÄ üìÑ .dockerignore               # Docker build optimization
‚îú‚îÄ‚îÄ üìÑ DOCKER.md                   # Docker setup guide
‚îú‚îÄ‚îÄ üìÑ CLAUDE.md                   # AI assistant instructions
‚îú‚îÄ‚îÄ üìÑ README.md                   # This file
‚îî‚îÄ‚îÄ üìÑ package.json                # Root scripts and dependencies
```

## üß™ Testing

```bash
# Run all tests
npm run test

# Run backend tests only
cd backend && npm test

# Run frontend tests only 
cd frontend && npm test

# Run tests with coverage
npm run test:coverage
```

## üêõ Troubleshooting

<details>
<summary><strong>üîß Common Issues</strong></summary>

### Database Connection Issues
```bash
# Check Supabase connection
# Verify .env file has correct SUPABASE_URL and keys
# Ensure APP_ENV matches your intended environment
```

### Puppeteer Installation Problems
```bash
# Force reinstall Puppeteer
npm install puppeteer --force

# Or use system Chrome
export PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
```

### Port Conflicts
```bash
# Check what's using the ports
netstat -ano | findstr :3001  # Backend
netstat -ano | findstr :3000  # Frontend

# Kill processes (Windows)
taskkill /PID <PID> /F

# Kill processes (Linux/Mac)
kill -9 <PID>
```

### Environment Configuration
- ‚úÖ Verify `APP_ENV` is set correctly (`development` or `production`)
- ‚úÖ Check that Supabase URLs and keys match your projects
- ‚úÖ Ensure CORS origins match your frontend URL
- ‚úÖ Confirm database setup scripts have been run successfully

### Docker Issues
```bash
# Rebuild containers
docker-compose down
docker-compose build --no-cache
docker-compose up

# Check logs
docker-compose logs -f
```

### Memory Issues
- Restart both development servers
- Check system resource usage
- Consider increasing Node.js memory limit:
  ```bash
  NODE_OPTIONS="--max-old-space-size=4096" npm run dev
  ```

</details>

## ü§ù Contributing

We welcome contributions! Please follow these steps:

1. **üç¥ Fork** the repository
2. **üåø Create** a feature branch: `git checkout -b feature/amazing-feature`
3. **üíª Make** your changes following our coding standards
4. **üß™ Test** your changes thoroughly
5. **üìù Commit** with clear messages: `git commit -m 'Add amazing feature'`
6. **üöÄ Push** to your branch: `git push origin feature/amazing-feature`
7. **üìÆ Submit** a Pull Request

### Development Guidelines
- Follow existing code style and conventions
- Add tests for new functionality
- Update documentation as needed
- Ensure all tests pass before submitting

## üìÑ License

This project is licensed under the **MIT License** - see the [LICENSE](LICENSE) file for details.

## üí¨ Support & Community

<div align="center">

### üÜò Need Help?

| Resource | Description |
|----------|-------------|
| üìö [Documentation](./docs/) | Complete project documentation |
| üêõ [Issues](https://github.com/your-username/streetwiseweb/issues) | Bug reports and feature requests |
| üí¨ [Discussions](https://github.com/your-username/streetwiseweb/discussions) | Community discussions and Q&A |
| üìß [Email](mailto:support@streetwiseweb.com) | Direct support contact |

### üôè Acknowledgments

Built with amazing open-source tools:
- [axe-core](https://github.com/dequelabs/axe-core) for accessibility testing
- [Puppeteer](https://github.com/puppeteer/puppeteer) for web automation
- [React](https://reactjs.org/) for the frontend
- [Supabase](https://supabase.com/) for backend services
- [Node.js](https://nodejs.org/) for the runtime

</div>

---

<div align="center">

**Made with ‚ù§Ô∏è for a more accessible web**

[‚≠ê Star this project](https://github.com/your-username/streetwiseweb) | [üêõ Report Bug](https://github.com/your-username/streetwiseweb/issues) | [üí° Request Feature](https://github.com/your-username/streetwiseweb/issues)

</div>